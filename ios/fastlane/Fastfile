default_platform(:ios)

platform :ios do
  private_lane :build do |options|
    type = (options[:type] || "development")
    export_method = (options[:export_method] || "development")

	if is_ci
		setup_ci
	end
	sync_code_signing(
	    type: type,
	    readonly: true
	)
	disable_automatic_code_signing(path: "mobile_medziotojas.xcodeproj")
	build_ios_app(
        export_method: export_method,
        silent: false
	)
	enable_automatic_code_signing(path: "mobile_medziotojas.xcodeproj")
  end

  desc "Continuous integration"
  lane :ci do
       build(type: "development", export_method: "development")
  end

  desc "Release to TestFlight for internal testing"
  lane :internal_testing do
       app_store_connect_api_key
       build(type: "appstore", export_method: "app-store")
       upload_to_testflight
  end
end
